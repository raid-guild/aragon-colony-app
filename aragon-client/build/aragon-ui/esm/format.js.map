{"version":3,"file":"format.js","sources":["../../src/utils/format.js"],"sourcesContent":["import JSBI from 'jsbi'\nimport { NO_BREAK_SPACE } from './characters'\nimport { divideRoundBigInt } from './math'\n\n/**\n * Formats an integer based on a limited range.\n *\n * Example:\n *   formatIntegerRange(234, 0, 99, '+') === \"99+\"\n *\n * @param {number} value     The number to format.\n * @param {number} min       Range minimum.\n * @param {number} max       Range maximum.\n * @param {number} maxSuffix Suffix to add if the value exceeds the max.\n */\nexport function formatIntegerRange(\n  value = -1,\n  min = 0,\n  max = 99,\n  maxSuffix = ''\n) {\n  value = parseInt(value, 10)\n  if (value <= min) {\n    return `${parseInt(min, 10)}`\n  }\n  if (value > max) {\n    return `${parseInt(max, 10)}${maxSuffix}`\n  }\n  return String(value)\n}\n\n/**\n * Formats a number for display purposes.\n *\n * This function is not using Intl.NumberFormat() to be compatible with big\n * integers expressed as string, or BigInt-like objects.\n *\n * @param {BigInt|string|number} number Number to convert\n * @returns {string}\n */\nexport function formatNumber(number) {\n  const numAsString = String(number)\n  const [integer, decimals] = numAsString.split('.')\n\n  return [...integer].reverse().reduce(\n    (result, digit, index) => {\n      return digit + (index > 0 && index % 3 === 0 ? ',' : '') + result\n    },\n    decimals ? `.${decimals}` : ''\n  )\n}\n\n/**\n * Formats a token amount for display purposes.\n *\n * @param {BigInt|string|number} amount              Number to round\n * @param {BigInt|string|number} decimals            Decimal placement for amount\n * @param {BigInt|string|number} digits              Rounds the number to a given decimal place\n * @param {boolean}              options.displaySign Decides if the sign should be displayed\n * @param {string}               options.symbol      Symbol for the token amount\n * @returns {string}\n */\nexport function formatTokenAmount(\n  amount,\n  decimals,\n  { digits = 2, symbol = '', displaySign = false } = {}\n) {\n  amount = JSBI.BigInt(String(amount))\n  decimals = JSBI.BigInt(String(decimals))\n  digits = JSBI.BigInt(String(digits))\n\n  if (JSBI.lessThan(decimals, 0)) {\n    throw new Error('formatTokenAmount(): decimals cannot be negative')\n  }\n\n  if (JSBI.lessThan(digits, 0)) {\n    throw new Error('formatTokenAmount(): digits cannot be negative')\n  }\n\n  const _0 = JSBI.BigInt(0)\n  const _10 = JSBI.BigInt(10)\n  const negative = JSBI.lessThan(amount, _0)\n\n  if (negative) {\n    amount = JSBI.unaryMinus(amount)\n  }\n\n  const amountConverted = JSBI.BigInt(\n    divideRoundBigInt(\n      amount,\n      JSBI.exponentiate(_10, JSBI.subtract(decimals, digits))\n    )\n  )\n\n  const leftPart = formatNumber(\n    JSBI.divide(amountConverted, JSBI.exponentiate(_10, digits))\n  )\n\n  const rightPart = String(\n    JSBI.remainder(amountConverted, JSBI.exponentiate(_10, digits))\n  )\n    .padStart(digits, '0')\n    .replace(/0+$/, '')\n\n  return [\n    displaySign ? (negative ? '-' : '+') : '',\n    leftPart,\n    rightPart ? `.${rightPart}` : '',\n    symbol ? `${NO_BREAK_SPACE}${symbol}` : '',\n  ].join('')\n}\n"],"names":["formatIntegerRange","value","min","max","maxSuffix","parseInt","String","formatNumber","number","numAsString","split","integer","decimals","reverse","reduce","result","digit","index","formatTokenAmount","amount","digits","symbol","displaySign","JSBI","BigInt","lessThan","Error","_0","_10","negative","unaryMinus","amountConverted","divideRoundBigInt","exponentiate","subtract","leftPart","divide","rightPart","remainder","padStart","replace","NO_BREAK_SPACE","join"],"mappings":"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"}